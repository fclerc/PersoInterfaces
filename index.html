<!DOCTYPE HTML>

<html>
    <head>
        <link href="css/bootstrap.css" type="text/css" rel="stylesheet"/>
        <link href="XMLDisplay.css" type="text/css" rel="stylesheet"/>
        <link href="RulesInterface.css" type="text/css" rel="stylesheet"/>
        
        <style>
        
        </style>
    </head>
    
    <body>
    <div id="Profile" class="mains"></div>
    <div id="Rules" class="mains"></div>
    <div id="Context" class="mains"></div>
        <script type="text/javascript" src="jquery-2.1.1.js"></script>
        
        <script type="text/javascript" src="xmlManipulator.js"></script>
        <script type="text/javascript">
        
            $(function(){
                
				$.get('foveaStrategy.xml', function(data){//get the xml document
					//var xml = new Array;
					//xml['strategy']= $(data);//load xml tree
					var strategy = $(data);//load xml tree
					
					var profileFilename = $($(strategy).find('exploitedProfile')[0]).html();
					var contextFilename = $($(strategy).find('exploitedContext')[0]).html();
                    manipulateXML(profileFilename,'#Profile', 'select', "#Rules");
                    manipulateXML(contextFilename,'#Context', 'select', '#Rules');
                    
                    //var rules = $.parseXML('<rules></rules>');
                    //$(rules).append('ojbiob');
                    var currentOperation = 'start';
                    
                    
                    $("#Rules").on("leafValueReading", function(event, value, id, container){
                        $(event.target).append('You clicked on '+id+ ' which contains value ' + value + 'in the '+container+' part.<br/>');
                        
                        if(container == "#Profile"){
                        
                        }
                        
                    
                    });
                    
                    
                    //var rulesString = (new XMLSerializer()).serializeToString($(rules)[0]);
                    //console.log(rulesString);
                    
                    
                    
                    
                    
					//function used to keep the colons always visible when scrolling
					function alwaysVisible(elementId){
						var initialTop = $(elementId).offset().top;
					
						$(document).scroll(function(){
							var bottomWindowPosition = $(document).scrollTop() + $(window).height();
							
							if(bottomWindowPosition < $(document).height()){
								
								if($(elementId).height() < bottomWindowPosition){
									if($(elementId).height() > $(window).height()){
										$(elementId).css('margin-top',initialTop + bottomWindowPosition - $(elementId).height());
									}
									else{
										$(elementId).css('margin-top',initialTop + $(document).scrollTop());
									}
									
								}
								else{
									$(elementId).css('margin-top',initialTop);
								}
							}
						});
					}
					alwaysVisible('#Rules');
					alwaysVisible('#Profile');
					alwaysVisible('#Context');
                });
            
            });
            
            
        </script>
    </body>


</html>
